<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Secure Login</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      background: url("https://imgs.search.brave.com/jYSpme9BrZTxAafPbNvXvB_4FzFK0KlkZL3plKu-bP8/rs:fit:860:0:0:0/g:ce/aHR0cHM6Ly93YWxs/cGFwZXJzLmNvbS9p/bWFnZXMvaGQvY29s/b3JmdWwtYWJzdHJh/Y3Qtd2lzcHktc21v/a2UteW5hMGIyYWp3/aThueWx3Yy5qcGc") no-repeat center center fixed;
      background-size: cover;
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    .login-card {
      background: rgba(0, 0, 0, 0.5); /* más transparente */
      padding: 2rem;
      border-radius: 12px;
      border: 2px solid rgba(255, 255, 255, 0.3); /* contorno */
      color: white;
      width: 100%;
      max-width: 320px;
      box-shadow: 0px 0px 15px rgba(0,0,0,0.6);
    }
    .login-card h3 {
      text-align: center;
      margin-bottom: 1.5rem;
    }
    .btn-login {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      display: flex;
      justify-content: center;
      align-items: center;
      margin: 1rem auto 0 auto;
      background: linear-gradient(135deg, #0066ff, #00ccff);
      border: none;
      box-shadow: 0px 0px 8px rgba(0,0,0,0.5);
      transition: transform 0.2s ease-in-out;
    }
    .btn-login:hover {
      transform: scale(1.1);
    }
    .btn-login img {
      width: 24px;
      height: 24px;
      filter: invert(1); /* Si el SVG es oscuro, lo vuelve blanco */
    }
    .modal {
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  background: rgba(0,0,0,0.7);
  display: flex; justify-content: center; align-items: center;
}
.modal-content {
  background: #111;
  color: white;
  padding: 20px;
  border-radius: 10px;
  text-align: center;
}
.otp-inputs {
  display: flex;
  justify-content: center;
  gap: 10px;
  margin: 20px 0;
}
.otp-inputs input {
  width: 40px; height: 40px;
  text-align: center;
  font-size: 20px;
}
  </style>
</head>
<body>
  <div class="container">
    <div class="row">
      <!-- col-4 vacío -->
       <div class="col-8"></div>
      <div class="col-4 d-flex justify-content-center">
        <div class="login-card">
          <h3>Login</h3>
          <input type="text" id="username" class="form-control mb-3" placeholder="Usuario">
          <input type="password" id="password" class="form-control mb-3" placeholder="Contraseña">
          <button class="btn-login" id="btnLogin">
            <img src="https://imgs.search.brave.com/OOv_ZGjWCGKvvNg7lImrk8jkMZR00q17pWi4DSu3qlA/rs:fit:860:0:0:0/g:ce/aHR0cHM6Ly9pbWFn/ZXMudmV4ZWxzLmNv/bS9tZWRpYS91c2Vy/cy8zLzEzMTc5OC9p/c29sYXRlZC9wcmV2/aWV3L2NiNmU1MDk3/OWE1OTkyZmE5MmJk/NmRhMWE0MGYzMjZl/LWljb25vLWRlLWJv/dG9uLWRlLWVuY2Vu/ZGlkby1zaW1wbGUu/cG5n" alt="icono">
          </button>
        </div>
      </div>
    </div>
  </div>
  <div id="otpModal" class="modal" style="display:none;">
  <div class="modal-content">
    <h2>Verifica tu PIN</h2>
    <div class="otp-inputs">
      <input type="text" maxlength="1" oninput="moveNext(this, 0)">
      <input type="text" maxlength="1" oninput="moveNext(this, 1)">
      <input type="text" maxlength="1" oninput="moveNext(this, 2)">
      <input type="text" maxlength="1" oninput="moveNext(this, 3)">
      <input type="text" maxlength="1" oninput="moveNext(this, 4)">
      <input type="text" maxlength="1" oninput="moveNext(this, 5)">
    </div>
    <button id="verifyOtpBtn">Verificar</button>
  </div>
</div>
<script src="https://code.jquery.com/jquery-3.7.1.js" integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4=" crossorigin="anonymous"></script>
  <script>
    $(document).ready(function (){
        document.getElementById("otpModal").style.display = "flex";
    })
    // Simulación de login
async function login(username, password) {
  try {
    const res = await fetch("/login", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ username, password })
    });

    //const data = await res.json();
    const data = {success:true};
    if (data.success) {
      // ✅ Credenciales correctas, backend ya envió el PIN por correo
      document.getElementById("otpModal").style.display = "flex";
    } else {
      alert("Credenciales incorrectas");
    }
  } catch (err) {
    console.error(err);
  }
}

// Función para moverse al siguiente input automáticamente
function moveNext(input, index) {
  input.value = input.value.replace(/[^0-9]/g, ""); // solo números
  if (input.value && input.nextElementSibling) {
    input.nextElementSibling.focus();
  }
}

// Verificación del PIN ingresado
document.getElementById("verifyOtpBtn").addEventListener("click", async () => {
  const inputs = document.querySelectorAll(".otp-inputs input");
  let pin = "";
  inputs.forEach(i => pin += i.value);

  if (pin.length !== 6) {
    alert("Debes ingresar los 6 dígitos");
    return;
  }

  try {
    const res = await fetch("/verify-pin", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ pin })
    });

    const data = await res.json();

    if (data.valid) {
      alert("✅ Acceso concedido");
      document.getElementById("otpModal").style.display = "none";
    } else {
      alert("❌ PIN incorrecto");
    }
  } catch (err) {
    console.error(err);
  }
});

  </script>
</body>
</html>
